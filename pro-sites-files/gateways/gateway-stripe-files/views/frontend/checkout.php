<?php/** * Settings page for Stripe. * * @package    View * @subpackage Stripe */// Globals.global $psts, $current_site, $current_user;?><?php if ( $error_messages ) : ?>	<div id="psts-processcard-error">		<div class="psts-error">			<?php echo $error_messages; ?>		</div>	</div><?php endif; ?><form action="<?php echo $psts->checkout_url( $bid, $domain ); ?>" method="post" id="psts-stripe-checkout">	<input type="hidden" name="level" value="<?php echo $level; ?>"/>	<input type="hidden" name="period" value="<?php echo $period; ?>"/>	<input type="hidden" name="tax-type" value="none"/>	<input type="hidden" name="tax-country" value="none"/>	<input type="hidden" name="tax-evidence" value=""/>	<input type="hidden" name="plan_stripe_public_key" class="plan_stripe_public_key" value="<?php echo $public_key; ?>" />	<input type="hidden" name="plan_stripe_secret_key" class="plan_stripe_secret_key" value="<?php echo $psts->get_setting( 'stripe_secret_key' ); ?>" />	<?php if ( $new_blog ) : ?>		<input type="hidden" name="new_blog" value="1"/>	<?php endif; ?>	<?php if ( $bid ) : ?>		<input type="hidden" name="bid" value="<?php echo $bid; ?>"/>	<?php endif; ?>	<?php if ( $activation_key ) : ?>		<input type="hidden" name="activation" value="<?php echo $activation_key; ?>"/>		<?php if ( $user_name ) : ?>			<input type="hidden" name="blog_username" value="<?php echo $user_name; ?>"/>			<input type="hidden" name="blog_email" value="<?php echo $user_email; ?>"/>			<input type="hidden" name="blog_name" value="<?php echo $blogname; ?>"/>			<input type="hidden" name="blog_title" value="<?php echo $blog_title; ?>"/>		<?php endif; ?>	<?php endif; ?>	<!-- Checkout page flag. -->	<input type="hidden" name="psts_stripe_checkout" value="1" />	<?php if ( ! empty( $card->last4 ) ) : ?>		<h2><?php esc_html_e( 'Checkout Using Existing Credit Card', 'psts' ); ?></h2>		<p class="wpsaas-stripe-instructions"><?php esc_attr_e( 'You already have a credit card on your Stripe account.', 'psts' ); ?></p>		<table class="wpsaas-card-table-detail">			<tr>				<td><?php esc_html_e( 'Existing Card:', 'psts' ); ?></td>				<td><?php printf( __( '%1$s ending in %2$s', 'psts' ), $card->brand, $card->last4 ); ?></td>			</tr>			<tr>				<td align="right"><?php esc_html_e( 'WordPress Password:', 'psts' ); ?></td>				<td>					<input name="wp_password" size="15" type="password" title="<?php esc_attr_e( 'Enter the WordPress password that you login with.', 'psts' ); ?>"/>				</td>			</tr>			<tr>				<td align="right"><?php esc_html_e( 'Use Existing Card:', 'psts' ); ?></td>				<td>					<button type="button" id="psts-existing-submit"><?php esc_html_e( 'Submit Payment', 'psts' ); ?></button>				</td>			</tr>		</table>	<?php endif; ?>	<h2><?php esc_html_e( 'Checkout With a Credit Card', 'psts' ); ?></h2>	<p class="wpsaas-stripe-instructions"><?php esc_attr_e( 'Checkout using your credit card within a secure Stripe payment form.', 'psts' ); ?></p>	<table id="psts-cc-table-existing" class="wpsaas-card-table-detail">		<tr>			<td align="right"><?php esc_html_e( 'Set as default card:', 'psts' ); ?></td>			<td>				<input name="default_card" type="checkbox" value="1" <?php checked( empty( $card ) ); ?> />			</td>		</tr>		<tr>			<td><?php esc_html_e( 'Use a credit card:', 'psts' ); ?></td>			<td>			</td>		</tr>		</tr>	</table>	<div class="wpsaas-stripe-wrap">		<div class="form-group card-icon-wrap">			<div class="card-icon">				<svg role="img" class="Icon" width="30" height="30" fill="#2b2b2b" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30">				  <title><?php _e( 'Credit Card', 'psts' ) ?></title>				  <path fill-rule="evenodd" transform="translate(8, 10)" d="M2.00585866,0 C0.898053512,0 0,0.900176167 0,1.99201702 L0,9.00798298 C0,10.1081436 0.897060126,11 2.00585866,11 L11.9941413,11 C13.1019465,11 14,10.0998238 14,9.00798298 L14,1.99201702 C14,0.891856397 13.1029399,0 11.9941413,0 L2.00585866,0 Z M2.00247329,1 C1.44882258,1 1,1.4463114 1,1.99754465 L1,9.00245535 C1,9.55338405 1.45576096,10 2.00247329,10 L11.9975267,10 C12.5511774,10 13,9.5536886 13,9.00245535 L13,1.99754465 C13,1.44661595 12.544239,1 11.9975267,1 L2.00247329,1 Z M1,3 L1,5 L13,5 L13,3 L1,3 Z M11,8 L11,9 L12,9 L12,8 L11,8 Z M9,8 L9,9 L10,9 L10,8 L9,8 Z M9,8"></path>				</svg>			</div>			<div id="wpsaas-stripe-card-number" class="input empty"></div>		</div>		<div class="form-group form-group-half">			<div class="card-icon-wrap">				<div class="card-icon">					<svg role="img" class="Icon" width="30" height="30" fill="#2b2b2b" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30">					  <title><?php _e( 'Calendar', 'psts' ) ?></title>					  <path fill-rule="evenodd" transform="translate(8, 9)" d="M2.0085302,1 C0.899249601,1 0,1.90017617 0,2.99201702 L0,10.007983 C0,11.1081436 0.901950359,12 2.0085302,12 L9.9914698,12 C11.1007504,12 12,11.0998238 12,10.007983 L12,2.99201702 C12,1.8918564 11.0980496,1 9.9914698,1 L2.0085302,1 Z M1.99539757,4 C1.44565467,4 1,4.43788135 1,5.00292933 L1,9.99707067 C1,10.5509732 1.4556644,11 1.99539757,11 L10.0046024,11 C10.5543453,11 11,10.5621186 11,9.99707067 L11,5.00292933 C11,4.44902676 10.5443356,4 10.0046024,4 L1.99539757,4 Z M3,1 L3,2 L4,2 L4,1 L3,1 Z M8,1 L8,2 L9,2 L9,1 L8,1 Z M3,0 L3,1 L4,1 L4,0 L3,0 Z M8,0 L8,1 L9,1 L9,0 L8,0 Z M8,0"></path>					</svg>				</div>				<div id="wpsaas-stripe-card-expiry" class="input empty"></div>			</div>			<div class="card-icon-wrap">				<div class="card-icon">					<svg role="img" class="Icon" width="30" height="30" fill="#2b2b2b" focusable="false" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 30 30">					  <title><?php _e( 'Lock', 'psts' ) ?></title>					  <path fill-rule="evenodd" transform="translate(9, 9)" d="M8.8,4 C8.8,1.79086089 7.76640339,4.18628304e-07 5.5,0 C3.23359661,-4.1480896e-07 2.2,1.79086089 2.2,4 L3.2,4 C3.2,2.34314567 3.81102123,0.999999681 5.5,1 C7.18897877,1.00000032 7.80000001,2.34314567 7.80000001,4 L8.8,4 Z M1.99201702,4 C0.891856397,4 0,4.88670635 0,5.99810135 L0,10.0018986 C0,11.1054196 0.900176167,12 1.99201702,12 L9.00798298,12 C10.1081436,12 11,11.1132936 11,10.0018986 L11,5.99810135 C11,4.89458045 10.0998238,4 9.00798298,4 L1.99201702,4 Z M1.99754465,5 C1.44661595,5 1,5.45097518 1,5.99077797 L1,10.009222 C1,10.5564136 1.4463114,11 1.99754465,11 L9.00245535,11 C9.55338405,11 10,10.5490248 10,10.009222 L10,5.99077797 C10,5.44358641 9.5536886,5 9.00245535,5 L1.99754465,5 Z M1.99754465,5"></path>					</svg>				</div>				<div id="wpsaas-stripe-card-cvc" class="input empty"></div>			</div>		</div>		<div class="form-group">			<div class="payment-errors"></div>		</div>		<div class="wpsaas-stripe-button-wrap">			<div id="card-errors" role="alert" style="display: none;"></div>			<button id="btnSubmit" class="btn wpsaas-stripe-button"><?php _e( 'Pay', 'psts' ) ?></button>			<div class="payment_processing" style="display: none;"><?php _e( '<img src="' . $psts->plugin_url . 'images/loading.gif"> Processing...', 'psts' ) ?></div>		</div>		<div class="error payment-error" role="alert">			<span class="message"></span>		</div>	</div></form><script src="https://js.stripe.com/v3/"></script><script>	jQuery( document ).ready( function ( $ ) {		var stripe_public_key = jQuery( '.plan_stripe_public_key' ).val(); 		var stripe_secret_key = jQuery( '.plan_stripe_secret_key' ).val(); 		var stripe = Stripe( stripe_public_key );		var elements = stripe.elements();		var style = {			base: {				fontFamily: '"Open Sans", Helvetica,Arial,Lucida,sans-serif',				fontSmoothing: 'antialiased',				fontSize: '16px',				'::placeholder': {					color: '#aab7c4'				},			},			invalid: {				color: '#ff0000',				iconColor: '#ff0000'			}		};				var cardNumber = elements.create('cardNumber', {			style: style,		});		cardNumber.mount('#wpsaas-stripe-card-number');		var cardExpiry = elements.create('cardExpiry', {			style: style,		});		cardExpiry.mount('#wpsaas-stripe-card-expiry');		var cardCvc = elements.create('cardCvc', {			style: style,		});		cardCvc.mount('#wpsaas-stripe-card-cvc');				var form = document.getElementById('psts-stripe-checkout');		form.addEventListener('submit', function (event) {			event.preventDefault();			stripe.createToken(cardNumber).then(function (result) {				if (result.error) {					// Inform the customer that there was an error.					jQuery( '#card-errors' ).show();					jQuery( '#card-errors' ).text(result.error.message);				} else {					var token_id = result.token.id;					// Create new input.					var tokenInput = document.createElement( 'INPUT' );					// Set required data.					tokenInput.setAttribute( 'type', 'hidden' );					tokenInput.setAttribute( 'name', 'stripeToken' );					tokenInput.setAttribute( 'value', token_id );					form.appendChild( tokenInput );					jQuery( '#card-errors' ).hide();					jQuery( '.wpsaas-stripe-button' ).prop( "disabled", true );					jQuery( '.payment_processing' ).show();					form.submit();				}			});		});	});</script>